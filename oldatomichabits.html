<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book Summary with Text-to-Speech</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary-color: #8B4513;
            --secondary-color: #A0522D;
            --background-color: #FDF5E6;
            --text-color: #3E2723;
            --accent-color: #D2691E;
            --shadow-color: rgba(139, 69, 19, 0.1);
            --card-background: #FFF8ED;
            --summary-background: #FFF3E0;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background-color: var(--background-color);
            background-image: linear-gradient(45deg, #f8e2ce 25%, transparent 25%),
                            linear-gradient(-45deg, #f8e2ce 25%, transparent 25%),
                            linear-gradient(45deg, transparent 75%, #f8e2ce 75%),
                            linear-gradient(-45deg, transparent 75%, #f8e2ce 75%);
            background-size: 20px 20px;
            background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
            color: var(--text-color);
            line-height: 1.7;
            padding: 2rem;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .container {
            max-width: 800px;
            background: var(--card-background);
            padding: 3rem;
            border-radius: 20px;
            box-shadow: 
                0 4px 6px var(--shadow-color),
                0 10px 15px var(--shadow-color);
            border: 1px solid rgba(139, 69, 19, 0.1);
            position: relative;
        }

        .loading-container {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background-color: rgba(139, 69, 19, 0.1);
            display: none;
        }

        .loading-bar {
            height: 100%;
            background: linear-gradient(to right, var(--primary-color), var(--accent-color));
            width: 0%;
            transition: width 0.8s ease-in-out;
        }
        
        h1 {
            color: var(--primary-color);
            font-size: 2.5rem;
            text-align: center;
            margin-bottom: 2rem;
            font-weight: 700;
            position: relative;
            padding-bottom: 1rem;
        }

        h1::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 4px;
            background: linear-gradient(to right, var(--primary-color), var(--accent-color));
            border-radius: 2px;
        }
        
        .controls {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin: 2rem 0;
            flex-wrap: wrap;
        }
        
        button {
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 10px;
            background: var(--primary-color);
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1rem;
            font-weight: 500;
        }
        
        button:hover {
            background: var(--accent-color);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(139, 69, 19, 0.2);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        button:disabled {
            background-color: #D2B48C;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .summary {
            background: var(--summary-background);
            padding: 2rem;
            border-radius: 15px;
            margin-top: 2rem;
            border: 1px solid rgba(139, 69, 19, 0.1);
        }
        
        .summary p {
            margin-bottom: 1.5rem;
            font-size: 1.1rem;
            color: var(--text-color);
        }

        .summary p:last-child {
            margin-bottom: 0;
        }

        @media (max-width: 640px) {
            body {
                padding: 1rem;
            }
            
            .container {
                padding: 1.5rem;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .summary {
                padding: 1rem;
            }
            
            button {
                padding: 0.6rem 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="loading-container">
            <div class="loading-bar"></div>
        </div>

        <h1>"Atomic Habits" by James Clear</h1>
        
        <div class="controls">
            <button onclick="speak()">
                <i class="fas fa-play"></i> Play Summary
            </button>
            <button onclick="pause()">
                <i class="fas fa-pause"></i> Pause
            </button>
            <button onclick="resume()">
                <i class="fas fa-redo"></i> Resume
            </button>
            <button onclick="stop()">
                <i class="fas fa-stop"></i> Stop
            </button>
        </div>
        
        <div class="summary">
            <p>
                "Atomic Habits" by James Clear is a groundbreaking exploration of how tiny changes can lead to remarkable results. The book begins by introducing the concept of atomic habits - small, regular practices that are both easy to do and have the potential to compound over time into extraordinary outcomes. Clear explains that if you can get just 1% better each day, you'll end up thirty-seven times better by the end of the year.
            </p>
            <p>
                The foundation of the book rests on four fundamental laws of behavior change. The First Law (Make it Obvious) emphasizes the importance of understanding and optimizing your environment to make good habits more visible and bad habits invisible. Clear introduces techniques like habit stacking and environmental design to make desired behaviors more obvious and automatic.
            </p>
            <p>
                The Second Law (Make it Attractive) delves into the role of dopamine and desire in habit formation. Clear explains how to use temptation bundling and make habits more appealing by connecting them with activities you already enjoy. He also explores how social norms and community influence can make certain habits more attractive.
            </p>
            <p>
                The Third Law (Make it Easy) focuses on reducing friction associated with good habits while increasing friction for bad ones. Clear introduces the Two-Minute Rule, suggesting that any habit can be scaled down into a two-minute version, making it easier to start. He emphasizes that the real key to building lasting habits is making them as easy as possible to start.
            </p>
            <p>
                The Fourth Law (Make it Satisfying) addresses the importance of immediate reward in habit formation. Clear explains how to use habit tracking, reward systems, and other techniques to make good habits immediately satisfying, while making bad habits feel unsatisfying. He emphasizes that what is immediately rewarded is repeated, while what is immediately punished is avoided.
            </p>
            <p>
                A crucial insight from the book is the concept of identity-based habits. Clear argues that the most effective way to change behavior is to focus on who you wish to become rather than what you want to achieve. He explains that every action you take is a vote for the type of person you want to be, and that true behavior change is identity change.
            </p>
            <p>
                The book also explores advanced strategies like habit stacking, habit tracking, and the role of deliberate practice in habit formation. Clear provides practical techniques for breaking bad habits, including reducing exposure to habit triggers, making bad behaviors more difficult, and changing the associations you have with harmful routines.
            </p>
            <p>
                Clear concludes by addressing how to maintain habits and continue progressing over the long term. He discusses the importance of periodic review and adjustment of your habits, finding the right level of challenge, and avoiding the plateau of latent potential. The book emphasizes that success is not about breakthrough moments but about consistently showing up and making small improvements day after day.
            </p>
        </div>
    </div>

    <script>
        let speech = null;
        let speechQueue = [];
        let isPlaying = false;
        const loadingContainer = document.querySelector('.loading-container');
        const loadingBar = document.querySelector('.loading-bar');
    
        function showLoadingBar() {
            loadingContainer.style.display = 'block';
            loadingBar.style.width = '0%';
            loadingBar.offsetHeight;
            loadingBar.style.width = '100%';
        }

        function hideLoadingBar() {
            loadingContainer.style.display = 'none';
            loadingBar.style.width = '0%';
        }
    
        function getPreferredVoice() {
            const preferredVoices = [
                "Google UK English Female",
                "Google US English",
                "Microsoft David Desktop - English (United States)",
                "Google UK English Male",
                "Google Deutsch",
            ];
    
            const voices = window.speechSynthesis.getVoices();
            return preferredVoices.reduce((found, preferred) => 
                found || voices.find(v => v.name.includes(preferred) || v.lang.includes(preferred)), null
            ) || (voices.length > 0 ? voices[0] : null);
        }

        function splitIntoChunks(text) {
            const chunks = [];
            const sentences = text.match(/[^.!?]+[.!?]+/g) || [];
            let currentChunk = '';

            sentences.forEach(sentence => {
                if (currentChunk.length + sentence.length < 200) {
                    currentChunk += sentence;
                } else {
                    if (currentChunk) chunks.push(currentChunk.trim());
                    currentChunk = sentence;
                }
            });

            if (currentChunk) chunks.push(currentChunk.trim());
            return chunks;
        }

        function speakChunk() {
            if (speechQueue.length === 0 || !isPlaying) {
                isPlaying = false;
                return;
            }

            const chunk = speechQueue.shift();
            speech = new SpeechSynthesisUtterance(chunk);
            speech.voice = getPreferredVoice();
            speech.rate = 0.85;
            speech.pitch = 1.2;

            speech.onend = () => {
                if (isPlaying) {
                    speakChunk();
                }
            };

            window.speechSynthesis.speak(speech);
        }
    
        function speak() {
            stop();
            showLoadingBar();
    
            const text = document.querySelector('.summary').textContent;
            speechQueue = splitIntoChunks(text);
            isPlaying = true;

            setTimeout(() => {
                hideLoadingBar();
                speakChunk();
            }, 800);

            // Add periodic reset to prevent Chrome bug
            setInterval(() => {
                if (isPlaying && !window.speechSynthesis.speaking) {
                    speakChunk();
                }
            }, 2599);
        }
    
        function pause() {
            isPlaying = false;
            window.speechSynthesis.pause();
        }
    
        function resume() {
            isPlaying = true;
            window.speechSynthesis.resume();
            if (!window.speechSynthesis.speaking) {
                speakChunk();
            }
        }
    
        function stop() {
            isPlaying = false;
            speechQueue = [];
            window.speechSynthesis.cancel();
            hideLoadingBar();
        }
    
        if (speechSynthesis.onvoiceschanged !== undefined) {
            speechSynthesis.onvoiceschanged = () => {
                window.speechSynthesis.getVoices();
            };
        }
    </script>
</body>
</html>